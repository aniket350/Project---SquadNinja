import { Component, OnInit ,Input} from '@angular/core';
import { $, element } from 'protractor';
import { FormControl } from '@angular/forms';
import {AutogenerateService} from '../../services/autogenServices/autogenerate.service';
import {HttpClient} from '@angular/common/http';
import { map } from 'rxjs/operators';
import { SpprofileserService } from '../../services/spprofileser/spprofileser.service';
@Component({
  selector: 'app-auto-generate-team',
  templateUrl: './auto-generate-team.component.html',
  styleUrls: ['./auto-generate-team.component.scss']
})
export class AutoGenerateTeamComponent implements OnInit {
  public items: any;
  public postedIdeaDetails: any;
​
  public data;
  public auto: any=[];

  status="done";
  acceptedData: any = [];
  toggle = true;
  title:any="";
  obj1:any="";
  obj:any="";
  disabled:boolean=true;
  roleCards=[];
  tabs=[];
  response:any;
  x: any = [];
  accept:any=[];
  sendAccept={
    role:{
      role:"",
      experience:"",
      skills:[],
    }
}
  constructor( private http:HttpClient,private autogeneratesp:AutogenerateService,private spprofileserService: SpprofileserService) { }
  ngOnInit() {
     let  disp=[];
// this.getPostedIdeas();
    this.title=localStorage.getItem("title");
    this.obj=localStorage.getItem("Role");
    this.obj1=JSON.parse(this.obj);
    for(let role of this.obj1){
        this.tabs.push(role.role);
        this.getAnyTeam(role.role);
      }

}
​
sendAutogenTeam(){
  console.log(this.acceptedData);
  ['currentLocation' ,'domain','id' ,'idea','preferredLocation', 'ideaDto' , 'previousProject', 'skillList','subDomain','acceptStatus','timestamp','workedIdeas','invitedIdeas'].forEach(element =>
  this.acceptedData.forEach(e => {
      delete e[element];
    })
  );
  console.log(this.acceptedData);
  this.autogeneratesp.sendAutogeneratedTeam(this.acceptedData,this.title).subscribe((data)=>{
  this.response=data;
  });
}
getAnyTeam(role: any){
  // console.log(role);
​
  this.spprofileserService.getSearchResults(role).subscribe((data) => {
    console.log(data);
  this.auto.push(data);
  console.log(this.auto,"Before adding");
  for(let detail of this.auto){
    for(let data of detail){
        data.acceptStatus="Accept";
    }
  }
  console.log(this.auto,"After adding");
});
 }
 checkStatus(card): any{
    if(card.acceptStatus==="Accept"||card.acceptStatus==="Accepted")
      return "done";
    else
      return "clear";
 }
 clickAccept(card,index,i) {
   console.log(card.acceptStatus);
   console.log(index);
   console.log(i);
   if(card.acceptStatus==="Accept"||card.acceptStatus==="Accepted"){
      card.acceptStatus="rejected";
      this.acceptedData.push(card);
   }
 else{
    card.acceptStatus="Accepted";
 }
 }
}
